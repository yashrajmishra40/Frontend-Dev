<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Q1 - Real-Time Live Search</title>
    <script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
    <style>
      body {
        font-family: Arial;
        margin: 20px;
      }
      .product {
        display: flex;
        gap: 10px;
        align-items: center;
        padding: 8px;
        border-bottom: 1px solid #eee;
      }
      img {
        width: 60px;
        height: 60px;
        object-fit: cover;
      }
      #loading {
        display: none;
      }
    </style>
  </head>
  <body>
    <h2>Real-Time Live Search (/products)</h2>
    <input id="search" placeholder="Search products..." autocomplete="off" />
    <div id="loading">Loading...</div>
    <div id="results"></div>

    <script>
      const API = "http://localhost:3001/products";
      $("#search").on("input", function () {
        const qVal = $(this).val().trim();
        $("#results").empty();
        if (qVal === "") return;
        $("#loading").show();
        $.ajax({
          url: API,
          data: { q: qVal },
          method: "GET",
          success: function (data) {
            $("#loading").hide();
            if (!data || data.length === 0) {
              $("#results").html("<div>No products found</div>");
              return;
            }
            const html = data
              .map(
                (p) =>
                  `<div class="product"><img src="${p.image}" alt=""><div><strong>${p.name}</strong><br/>â‚¹${p.price}</div></div>`
              )
              .join("");
            $("#results").html(html);
          },
          error: function () {
            $("#loading").hide();
            $("#results").html(
              '<div style="color:red">Error fetching products</div>'
            );
          },
        });
      });
    </script>
  </body>
</html>
